{"meta":{"title":"Turtle","subtitle":"廖亮的博客","description":"Stay hungry, stay young！","author":"廖亮","url":"http://blog.turtletl.com"},"pages":[{"title":"open-source","date":"2016-10-13T14:16:25.000Z","updated":"2016-10-13T14:16:52.891Z","comments":true,"path":"open-source/index.html","permalink":"http://blog.turtletl.com/open-source/index.html","excerpt":"","text":""},{"title":"about","date":"2016-10-13T14:20:00.000Z","updated":"2016-10-13T14:20:53.318Z","comments":true,"path":"about/index.html","permalink":"http://blog.turtletl.com/about/index.html","excerpt":"","text":""},{"title":"bookmark","date":"2016-10-13T14:20:09.000Z","updated":"2016-10-13T14:21:10.215Z","comments":true,"path":"bookmark/index.html","permalink":"http://blog.turtletl.com/bookmark/index.html","excerpt":"","text":""}],"posts":[{"title":"Centos7下安装mongodb数据库","slug":"Centos7下安装mongodb数据库","date":"2016-10-17T10:31:55.000Z","updated":"2016-10-17T10:33:07.937Z","comments":true,"path":"2016/10/17/Centos7下安装mongodb数据库/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Centos7下安装mongodb数据库/","excerpt":"一、安装mongodb在/etc/yum.repos.d目录下添加mongodb源新建mongodb-org-3.0.repo文件","text":"一、安装mongodb在/etc/yum.repos.d目录下添加mongodb源新建mongodb-org-3.0.repo文件12345[mongodb-org-3.0]name=MongoDB Repositorybaseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.0/x86_64/gpgcheck=0enabled=1 保存退出yum命令安装mongodb-org1yum install mongodb-org 在根目录下新建/data/db目录1mkdir -p /data/db 启动mongod1systemctl start mongod 停止mongod1systemctl stop mongod 重启mongod1systemctl restart mongod 二、安装php-mongodb扩展下载php-mongodb扩展1wget http://pecl.php.net/get/mongo-1.6.12.tgz 解压1tar xvzf mongo-1.6.12 编译安装1234cd mongo-1.6.12phpize./configure --with-php-config=/usr/bin/php-configmake &amp;&amp; make install 在安装过程中可能会报以下错误1/var/tmp/mongo/contrib/php-ssl.h:33:25: error: openssl/evp.h: No such file or directory 需要安装openssl-devel1yum install openssl-devel 在php.ini文件中添加extension=mongo.so1extension=mongo.so 重启php-fpm或服务器1systemctl restart php-fpm","categories":[],"tags":[],"keywords":[]},{"title":"Centos7添加epel源并升级php","slug":"Centos7添加epel源并升级php","date":"2016-10-17T10:30:44.000Z","updated":"2016-10-17T10:31:05.767Z","comments":true,"path":"2016/10/17/Centos7添加epel源并升级php/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Centos7添加epel源并升级php/","excerpt":"最近在阿里云上入手了一台centos7的服务器，在搭建环境过程中发现php的版本是5.4，且是最新的。可现在php都已经到7了，经查询发现centos为保持稳定性并没用太多的更新源，使得一些软件都过于老。因此为了使用到最新的php版本，我们得在centos中添加一些较新的源。目前在centos系统中较流行的源有epel和remi。接下来我们会添加这两种源来升级php版本。","text":"最近在阿里云上入手了一台centos7的服务器，在搭建环境过程中发现php的版本是5.4，且是最新的。可现在php都已经到7了，经查询发现centos为保持稳定性并没用太多的更新源，使得一些软件都过于老。因此为了使用到最新的php版本，我们得在centos中添加一些较新的源。目前在centos系统中较流行的源有epel和remi。接下来我们会添加这两种源来升级php版本。 ##一、安装源1rpm -Uvh http://ftp.iij.ad.jp/pub/linux/fedora/epel/7/x86_64/e/epel-release-7-5.noarch.rpm 1rpm -Uvh http://rpms.famillecollet.com/enterprise/remi-release-7.rpm ##二、确认需要安装的php版本1yum list --enablerepo=remi --enablerepo=remi-php56 | grep php ##三、卸载已经安装的php版本如果系统中已经安装了较低的php版本，请先卸载掉1yun remove php* ##四、安装较新的php版本1yum install --enablerepo=remi --enablerepo=remi-php56 php php-opcache php-pecl-apcu php-devel php-mbstring php-mcrypt php-mysqlnd php-phpunit-PHPUnit php-pecl-xdebug php-pecl-xhprof php-pdo php-pear php-fpm php-cli php-xml php-bcmath php-process php-gd php-common ##查看php版本1php -v","categories":[],"tags":[],"keywords":[]},{"title":"利用redis存储session，解决登录同步问题","slug":"利用redis存储session，解决登录同步问题","date":"2016-10-17T10:29:09.000Z","updated":"2016-10-17T10:29:33.660Z","comments":true,"path":"2016/10/17/利用redis存储session，解决登录同步问题/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/利用redis存储session，解决登录同步问题/","excerpt":"##一、php session存储方式在php中，存储session可以使用files user memcached redis，对于小型单一网站可以直接使用files的方式存储session。使用缓存数据库存储session的好处是较之文件存储方式，在大用户量的情况下速度更快、性能更优。而且如果做分布式系统的话，使用数据库存储是很好的方式。所以，如果使用数据库存储session，memecached和redis到底那种更好。","text":"##一、php session存储方式在php中，存储session可以使用files user memcached redis，对于小型单一网站可以直接使用files的方式存储session。使用缓存数据库存储session的好处是较之文件存储方式，在大用户量的情况下速度更快、性能更优。而且如果做分布式系统的话，使用数据库存储是很好的方式。所以，如果使用数据库存储session，memecached和redis到底那种更好。 ##二、redis和memcached的比较1、redis不仅仅支持简单的k/v类型的数据，同时还提供list、set、zset、hash等数据结构的存储;2、redis支持数据的备份，即master-slave模式的数据备份;3、redis支持数据的持久化，可以将内存中的数据保存到磁盘中，重启的时候可以再次加载进行使用;redis和memcached都是高性能的分布式缓存服务器，通过上述比较，考虑到如果重启服务器，memcached中的数据都会丢失，会影响用户的体验，所以使用redis存储session是比较好的方案。 ##三、redis存储session的php实现在我的上篇博客中，已经介绍了怎么安装redis服务器及phpredis扩展，具体请参考：http://blog.csdn.net/turtleo/article/details/499344971234567891011121314&lt;?phpini_set('session.gc_maxlifetime', 3600);ini_set('session.save_handler', \"redis\");ini_set(\"session.save_path\", \"tcp://127.0.0.1:6379\");session_start();$_SESSION['uid'] = \"2\";$_SESSION['username'] = \"turtle\";$redis = new Redis();$redis-&gt;connect('127.0.0.1', 6379);$user = $redis-&gt;get('PHPREDIS_SESSION:'.session_id()).'&lt;/br&gt;';echo $user;?&gt; 如果在配置文件中/etc/redis/6379.conf中开启了requirepass，这使用如下代码12345678910111213ini_set(&apos;session.gc_maxlifetime&apos;, 3600);ini_set(&apos;session.save_handler&apos;, &quot;redis&quot;);ini_set(&quot;session.save_path&quot;, &quot;tcp://127.0.0.1:6379?auth=password&quot;);session_start();$_SESSION[&apos;uid&apos;] = &quot;2&quot;;$_SESSION[&apos;username&apos;] = &quot;turtle&quot;;$redis = new Redis();$redis-&gt;connect(&apos;127.0.0.1&apos;, 6379);$redis-&gt;auth(&apos;turtletl.com&apos;);$user = $redis-&gt;get(&apos;PHPREDIS_SESSION:&apos;.session_id()).&apos;&lt;/br&gt;&apos;;echo $user;?&gt; 可以进行如下配置开启requirepass：1vim /etc/redis/6379.conf 具体配置文件依情况而定1requirepass 密码 重启redis服务器。","categories":[],"tags":[],"keywords":[]},{"title":"搭建NFS文件服务器","slug":"搭建NFS文件服务器","date":"2016-10-17T10:27:32.000Z","updated":"2016-10-17T10:28:17.947Z","comments":true,"path":"2016/10/17/搭建NFS文件服务器/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/搭建NFS文件服务器/","excerpt":"一、NFS简介NFS是Network File System的缩写，即网络文件系统。通过网络让不同的机器、不同的操作系统能够彼此分享个别的数据，让应用程序在客户端通过网络访问位于服务器磁盘中的数据，是在类Unix系统见实现磁盘文件共享的一种方法。NFS在文件传送或信息传送过程中依赖RPC协议。RPC，远程过程调用，是能是客户端执行其他系统中程序的一种机制。在之前的博客中，使用过rsync+inotify的方式搭建过实时同步服务器，但发现这种方法同步效果并不是特别好。","text":"一、NFS简介NFS是Network File System的缩写，即网络文件系统。通过网络让不同的机器、不同的操作系统能够彼此分享个别的数据，让应用程序在客户端通过网络访问位于服务器磁盘中的数据，是在类Unix系统见实现磁盘文件共享的一种方法。NFS在文件传送或信息传送过程中依赖RPC协议。RPC，远程过程调用，是能是客户端执行其他系统中程序的一种机制。在之前的博客中，使用过rsync+inotify的方式搭建过实时同步服务器，但发现这种方法同步效果并不是特别好。 二、安装NFS以下是基于Centos系统的1yum install nfs-utils 三、搭建NFS服务器1、将NFS server的/var/www/html共享给115.29.39.145网段，权限为读写。1vim /etc/exports 添加内容1/var/www/html 115.29.39.145(rw) 2、重启nfs服务器123systemctl restart rpcbindsystemctl restart nfsexportfs 3、nfs服务器端查看NFS的共享状态12showmount -eshowmount -a 4、客户端使用showmount命令查询NFS的共享状态1showmount -e 服务端ip 5、客户端挂载NFS服务器中的共享目录命令格式1mount NFS服务器IP:共享目录 本地挂载目录 查看是否挂载成功1mount | grep nfs 6、取消挂载1umount 本地目录 如果提示is busy，这使用如下命令取消挂载1umount -l 本地目录","categories":[],"tags":[],"keywords":[]},{"title":"centos服务器下配置nagios自动化运维工具","slug":"centos服务器下配置nagios自动化运维工具","date":"2016-10-17T10:25:48.000Z","updated":"2016-10-17T10:26:24.297Z","comments":true,"path":"2016/10/17/centos服务器下配置nagios自动化运维工具/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/centos服务器下配置nagios自动化运维工具/","excerpt":"Nagios是一款Linux上成熟的监视系统运行状态和网络信息的开源IT基础设施监视系统。Nagios能监视所指定的本地或远程主机服务，同时提供异常通知、事件处理等功能。与商业IT管理系统，如IBM Tivoli、HP OpenView/Operations等相比，Nagios具有成本低廉、结构简单、可维护性强等诸多优点，越来越受IT运维人员和系统管理员的青睐。","text":"Nagios是一款Linux上成熟的监视系统运行状态和网络信息的开源IT基础设施监视系统。Nagios能监视所指定的本地或远程主机服务，同时提供异常通知、事件处理等功能。与商业IT管理系统，如IBM Tivoli、HP OpenView/Operations等相比，Nagios具有成本低廉、结构简单、可维护性强等诸多优点，越来越受IT运维人员和系统管理员的青睐。本博客是基于Centos、apache环境搭建Nagios的。 ##一、安装Nagios1.安装前的准备(1)创建Nagios用户和用户组123useradd -s /sbin/nologin nagiosmkdir /usr/local/nagioschown -R nagios.nagios /usr/local/nagios (2)开启系统的sendmail服务在Nagios监控服务器上开启sendmail服务的作用是让Nagios在检测到故障时可以发送报警邮件。可以按如下需求配置sendmail服务12vim /etc/mail.rcset from=fromUser smtp=smtp服务器 smtp-auth-user=用户名 smtp-auth-password=密码 smtp-auth=login 2.安装Nagios1234567891011tar xvzf nagios-4.1.1.tar.gzcd nagios./configure --prefix=/usr/local/nagiosmake allmake installmake install-initmake install-commandmodemake install-configchkconfig --add nagioschkconfig --level 35 nagios onchkconfig --list nagios 3.安装Nagios插件Nagios提供的各种功能基本上是通过插件来完成的，而Nagios核心只提供了很少的监控功能。Nagios插件可以在www.nagios.org下载。12345tar xvzf nagios-plugins-2.1.1.tar.gzcd nagios-plugins-2.1.1./configure --prefix=/usr/local/nagiosmakemake install 4.配置apache1vim /etc/httpd/conf/httpd.conf 修改用户和用户组12User nagiosGroup nagios 找到DirectoryIndex index.html修改为12DirectoryIndex index.html index.phpAddType application/x-httpd-php .php 增加验证配置1234567891011121314151617181920212223242526#setting for nagiosScriptAlias /nagios/cgi-bin &quot;/usr/local/nagios/sbin&quot;&lt;Directory &quot;/usr/local/nagios/sbin&quot;&gt; AuthType Basic Options ExecCGI AllowOverride None Order allow,deny Allow from all AuthName &quot;nagios Access&quot; AuthUserFile /usr/local/nagios/etc/htpasswd Require valid-user&lt;/Directory&gt;Alias /nagios &quot;/usr/local/nagios/share&quot;&lt;Directory &quot;/usr/local/nagios/share&quot;&gt;AuthType Basic Options None AllowOverride None Order allow,deny Allow from all AuthName &quot;nagios Access&quot; AuthUserFile /usr/local/nagios/etc/htpasswd Require valid-user&lt;/Directory&gt; 创建Apache目录验证文件123htpasswd -c /usr/local/nagios/etc/htpasswd 用户名New password:(输入密码)Re-type new password:(确认密码) 重启Apache服务 ##二、配置Nagios(1)hosts.cfg文件此文件在默认情况下不存在，需要手动创建。hosts.cfg主要用来指定被监控的主机地址及相关属性信息。1234567891011121314151617181920212223define host &#123; use linux-server host_name web alias turtletl-web address 115.29.39.145&#125;define host &#123; use linux-server host_name turtletl alias turtletl.com address www.turtletl.com&#125;define hostgroup &#123; hostgroup_name sa-server alias sa server members web,turtletl&#125; 此文件创建了115.29.39.145和turtletl.com两个远程主机和一个主机组。（2）services.cfg文件此文件在默认情况下也不存在，需要创建。services.cfg文件主要用于定义监控服务和主机资源。123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566########################### web #################################define service &#123; use local-service host_name web service_description PING check_command check_ping!100.0,20%!500.0,60%&#125;define service &#123; use local-service host_name web service_description SSH check_command check_ssh&#125;define service &#123; use local-service host_name web service_description SSHD check_command check_tcp!22&#125;define service &#123; use local-service host_name web service_description http check_command check_http&#125;########################### turtletl ############################define service &#123; use local-service host_name turtletl service_description PING check_command check_ping!100.0,20%!500.0,60%&#125;define service &#123; use local-service host_name turtletl service_description SSH check_command check_ssh&#125;define service &#123; use local-service host_name turtletl service_description SSHD check_command check_tcp!22&#125;define service &#123; use local-service host_name turtletl service_description http check_command check_http&#125; 这里对这两个主机设置了4个监控服务。（3）contacts.cfg文件contacts.cfg是一个定义联系人和联系人组的配置文件，当监护的主机或服务出现故障时，Nagios会通过指定的通知将信息发送给指定的联系人或使用者。1234567891011121314151617define contact&#123; contact_name turtle ; Short name of user use generic-contact ; Inherit default values from generic-contact template (defined above) alias turtle Admin; Full name of user email 邮箱 ; &lt;&lt;***** CHANGE THIS TO YOUR EMAIL ADDRESS ******&gt;&gt;&#125;# CONTACT GROUPS# We only have one contact in this simple configuration file, so there is# no need to create more than one contact group.define contactgroup&#123; contactgroup_name admins alias Nagios Administrators members turtle&#125; (4)cgi.cfg文件在cgi.cfg文件中添加此用户的执行权限就可以。12345678default_user_name=turtleauthorized_for_system_information=turtleauthorized_for_configuration_information=turtleauthorized_for_system_commands=turtleauthorized_for_all_services=turtleauthorized_for_all_hosts=turtleauthorized_for_all_service_commands=turtleauthorized_for_all_host_commands=turtle (6)nagios.cfg文件将上面添加的文件在nagios.cfg文件中配置123456cfg_file=/usr/local/nagios/etc/objects/hosts.cfgcfg_file=/usr/local/nagios/etc/objects/services.cfgcfg_file=/usr/local/nagios/etc/objects/commands.cfgcfg_file=/usr/local/nagios/etc/objects/contacts.cfgcfg_file=/usr/local/nagios/etc/objects/timeperiods.cfgcfg_file=/usr/local/nagios/etc/objects/templates.cfg ##三、Nagios的运行和维护1.验证Nagios配置文件的正确性1/usr/local/nagios/bin/nagios -v /usr/local/nagios/etc/nagios.cfg 2.启动与停止Nagios(1）启动Nagios/usr/local/nagios/bin/nagios -d /usr/local/nagios/etc/nagios.cfg(2）关闭nagios1kill &lt;nagios_pid&gt; (3)重启nagios1kill -HUP &lt;nagios_pid&gt; ))","categories":[],"tags":[],"keywords":[]},{"title":"通过rsync工具搭建简单的远程容灾备份系统","slug":"通过rsync工具搭建简单的远程容灾备份系统","date":"2016-10-17T10:22:36.000Z","updated":"2016-10-17T10:23:00.444Z","comments":true,"path":"2016/10/17/通过rsync工具搭建简单的远程容灾备份系统/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/通过rsync工具搭建简单的远程容灾备份系统/","excerpt":"假定有两台服务器 A、B其中A系统作为网站服务器，B作为远程容灾备份机。远程容灾备份系统就是将A系统的数据通过守护进程定时备份到B服务器上，从而实现数据的远程容灾。","text":"假定有两台服务器 A、B其中A系统作为网站服务器，B作为远程容灾备份机。远程容灾备份系统就是将A系统的数据通过守护进程定时备份到B服务器上，从而实现数据的远程容灾。1、在A系统上配置rsync修改/etc/rsyncd.conf文件，配置内容如下：1234567891011121314151617181920212223242526272829303132333435# /etc/rsyncd: configuration file for rsync daemon mode# See rsyncd.conf man page for more options.# configuration example: uid = nobody gid = nobody use chroot = no max connections = 10 pid file = /var/run/rsyncd.pid lock file = /var/run/rsyncd.lock log file = /var/run/rsyncd.log# exclude = lost+found/# transfer logging = yes# timeout = 900# ignore nonreadable = yes# dont compress = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2# [ftp]# path = /home/ftp# comment = ftp export area[turtletl]path = 需要备份的目录comment = blog fileignore errorsread only = nowrite only = nohosts allow = *hosts deny = list = falseuid = rootgid = rootauth users = 用户名secrets file = /etc/server.pass 其中/etc/server.pass文件的内容如下：1用户名:密码 然后改变server.pass文件的权限1chmod 666 /etc/server.pass 2、启动rsync守护进程1rsync --daemon 3、在B系统上配置rsync在B系统上不需要做任何配置，只需在/etc下创建一个server.pass文件，内容为A系统中server.pass中的密码即可，并且改变权限为600，同时执行以下命令就可以完成手动备份：1rsync -vzrtopg --delete --progress --exclude &quot;*access*&quot; --exclude &quot;debug*&quot; 用户名@A服务器地址::A系统rsyncd.conf文件中的模块（如turtletl） 备份文件存放位置 --password-file /etc/server.pass 4、设置定时备份策略假定客户端rsync在每天凌晨3点30分执行镜像备份操作，在B服务器上执行“crontab -e”，然后添加如下信息即可：130 3 * * * rsync -vzrtopg --delete --progress --exclude &quot;*access*&quot; --exclude &quot;debug*&quot; 用户名@A服务器地址::A系统rsyncd.conf文件中的模块（如turtletl） 备份文件存放位置 --password-file /etc/server.pass 至此一个简单的远程容灾备份系统就算是搭建好了，但是这并不是一个完美的容灾方案。文章来源：http://www.turtletl.com","categories":[],"tags":[],"keywords":[]},{"title":"mysql导出为CSV的同时加上表头","slug":"mysql导出为CSV的同时加上表头","date":"2016-10-17T10:21:45.000Z","updated":"2016-10-17T10:22:05.784Z","comments":true,"path":"2016/10/17/mysql导出为CSV的同时加上表头/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/mysql导出为CSV的同时加上表头/","excerpt":"今天在使用mysql的into outfile命令将数据库数据导出为csv时，发现数据可以导出，但是列名却没有，但是却可以通过修改sql语句的方法加上表头，具体实现方法是在查找数据的时候并上列名：","text":"今天在使用mysql的into outfile命令将数据库数据导出为csv时，发现数据可以导出，但是列名却没有，但是却可以通过修改sql语句的方法加上表头，具体实现方法是在查找数据的时候并上列名：不带表头1select uid,nickname,realname,mobile,idcard from m order by m.uid desc into outfile &apos;/var/www/api/public/a/download/&quot;.$file_name.&quot;&apos; fields terminated by &apos;,&apos; optionally enclosed by &apos;\\&quot;&apos; escaped by &apos;\\&quot;&apos; lines terminated by &apos;\\r\\n&apos; 带上表头1select uid,nickname,realname,mobile,idcard from( select uid,nickname,realname,mobile,idcard from ims_mc_members union select &apos;uid&apos;,&apos;昵称&apos;,&apos;真实姓名&apos;,&apos;手机号&apos;, &apos;身份证号&apos;) m order by m.uid desc into outfile &apos;/var/www/api/public/a/download/&quot;.$file_name.&quot;&apos; fields terminated by &apos;,&apos; optionally enclosed by &apos;\\&quot;&apos; escaped by &apos;\\&quot;&apos; lines terminated by &apos;\\r\\n&apos; 文章来源：http://www.turtletl.com","categories":[],"tags":[],"keywords":[]},{"title":"解决Mysql ERROR 1 (HY000)问题","slug":"解决Mysql-ERROR-1-HY000-问题","date":"2016-10-17T10:20:46.000Z","updated":"2016-10-17T10:21:15.007Z","comments":true,"path":"2016/10/17/解决Mysql-ERROR-1-HY000-问题/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/解决Mysql-ERROR-1-HY000-问题/","excerpt":"今天在使用mysql语句的into outfile方法将Mysql导出为CSV时，出现ERROR 1 (HY000): Can’t create/write to file ‘/data/outfile.csv’ (Errcode: 13)问题，刚开始以为是读写权限问题，所以使用如下命令修改权限：","text":"今天在使用mysql语句的into outfile方法将Mysql导出为CSV时，出现ERROR 1 (HY000): Can’t create/write to file ‘/data/outfile.csv’ (Errcode: 13)问题，刚开始以为是读写权限问题，所以使用如下命令修改权限：1chmod 777 /data 然而发现并没有什么用，经查阅资料，发现要将文件所在目录加入到mysql用户组中，并成为mysql用户，所以使用如下命令修改目录所在的用户组：1chown mysql:mysql /data 本以为可以成功，然而问题还是依旧，没办法继续查阅资料，发现ubuntu服务器会限制mysql执行/usr/sbin/mysqld命令的执行，需要将这个目录加入到/etc/apparmor.d/usr.sbin.mysqld文件中，修改如下：12/data/ r, 添加要生成文件的路径/data/* rw, 添加要生成文件的路径 然后重启mysql服务器，重新执行命令，顺利写入，完成。文章来源：http://www.turtletl.com","categories":[],"tags":[],"keywords":[]},{"title":"解决数据库连接报ERROR 1045问题","slug":"解决数据库连接报ERROR-1045问题","date":"2016-10-17T10:19:15.000Z","updated":"2016-10-17T10:19:44.327Z","comments":true,"path":"2016/10/17/解决数据库连接报ERROR-1045问题/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/解决数据库连接报ERROR-1045问题/","excerpt":"今天在Centos服务器上安装mysql数据库，装完之后使用连接命令","text":"今天在Centos服务器上安装mysql数据库，装完之后使用连接命令1mysql -uroot -p 后，抛出如下命令1ERROR 1045 (28000): Access denied for user &apos;root&apos;@&apos;localhost&apos; (using password: NO) 以前也装过mysql数据库，默认密码都是为空的，现在安装完后，使用空密码也不行，经查阅资料，有如下解决办法：1、首先停止mysql进程1/etc/rc.d/init.d/mysqld stop 2、输入如下命令1mysqld_safe --user=mysql --skip-grant-tables --skip-networking &amp; 3、按回车进入下个命令行，然后连接数据库1mysql -u root mysql 4、进入到了mysql数据库中，使用如下命令修改数据库密码12update user set password=password(&apos;密码&apos;) where user=&apos;用户&apos;flush privileges 5、然后重启mysql数据库1systemctl start mysql 6、再以新密码登录数据库就可以解决问题了文章来源：http://www.turtletl.com","categories":[],"tags":[],"keywords":[]},{"title":"Centos下配置svn服务器","slug":"Centos下配置svn服务器","date":"2016-10-17T10:17:55.000Z","updated":"2016-10-17T10:18:17.164Z","comments":true,"path":"2016/10/17/Centos下配置svn服务器/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Centos下配置svn服务器/","excerpt":"entos服务器下面配置SVN服务器首先的安装SVN，一般情况下，大多数服务器都安装了svn服务器，其实安装过程也很简单，接下来看看看看怎么配置svn服务器：","text":"entos服务器下面配置SVN服务器首先的安装SVN，一般情况下，大多数服务器都安装了svn服务器，其实安装过程也很简单，接下来看看看看怎么配置svn服务器：1、在/root/目录下新建一个目录svn：mkdir svn2、进入到svn目录，新建版本库：svnadmin create admin3、在admin目录下，配置用户组及用户、密码进入authz文件，配置用户组和用户12345[groups]用户组 = 用户1、用户2......[/]@用户组 = rw 或 r 或 w 或无 进入passd文件，配置用户密码12用户名 = 密码... 4、往版本库中导入内容1svn import /var/www/admin svn://www.turtletl.com/admin 5、进入/var/www目录，将刚刚建立的版本库check out下来1svn co svn://www.turtletl.com/admin 6、然后就可以在本地checkout和commit了","categories":[],"tags":[],"keywords":[]},{"title":"Memcached缓存服务器","slug":"Memcached缓存服务器","date":"2016-10-17T10:16:56.000Z","updated":"2016-10-17T10:17:15.104Z","comments":true,"path":"2016/10/17/Memcached缓存服务器/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Memcached缓存服务器/","excerpt":"Memecached是一个免费开源的、高性能的、具有分布式内存对象的缓存系统，它通过减轻数据库负载加速动态web应用。","text":"Memecached是一个免费开源的、高性能的、具有分布式内存对象的缓存系统，它通过减轻数据库负载加速动态web应用。Memcached的特征：1、协议简单2、基于libevent的事件处理3、内置的内存管理系统4、互不通信的Memcached之间具有分布特征 ####安装Memcached####以centos为例：yum install memcached ####启动Memcached####memcached -m 32m -p 11211 -d -u root -P /avr/run/memcached.pid -c 256 -vv启动过程中所用的选项说明：-p 使用的TCP端口-m 最大内存大小-vv 以very vrebose模式启动，将调试信息和错误输出到控制台。-d 作为守护进程在后台运行-c 最大运行并发连接数-P 设置保存Memcached的pid文件-l 监听的服务器IP地址，如果有多个地址-u 运行Memcached的用户，默认不能有root用户启动，所以当用户为root时，需要利用-u参数来指定。 测试启动是否正常123456789101112131415[root@iZ284knd7ljZ /]# telnet localhost 11211Trying 127.0.0.1...Connected to localhost.Escape character is &apos;^&apos;&apos;.set test &apos;hello&apos; 0 10CLIENT_ERROR bad command line formatset test 0 0 10test_valueSTOREDget testVALUE test 0 10test_valueENDquitConnection closed by foreign host. ####关闭mecached####kill ‘cat /var/run/mecached.pid’ ####安装mecached的PHP扩展####已centos系统为例yum install php-pecl-memcache配置php.ini文件如果php.ini中没有extension=memcache.so扩展，添加该扩展。 ####测试memcache的扩展是否安装成功####12345678&lt;?php/*Memcached 缓存服务器 */$mem = New Memcache;$mem-&gt;connect('127.0.0.1', 11211);$mem-&gt;set('test', 'Hello world!', 0, 12);$val = $mem-&gt;get('test');echo $val;?&gt; 如果在浏览器输出Hello world则安装成功。","categories":[],"tags":[],"keywords":[]},{"title":"Nginx日志分割配置","slug":"Nginx日志分割配置","date":"2016-10-17T10:14:11.000Z","updated":"2016-10-17T10:15:17.957Z","comments":true,"path":"2016/10/17/Nginx日志分割配置/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Nginx日志分割配置/","excerpt":"Nginx日志文件分割配置","text":"Nginx日志文件分割配置 12345678#/bin/bash savepath_log = 'home/nginx/logs'nglogs = '/opt/nginx/logs'mkdir -p $savepath_log/$(date +%Y)/$(date +%m)mv $nglogs/access.log $savepath_log/$(date +%Y)/$(date +%m)/access.$(date +%Y%m%d).logmv $nglogs/error.log $savepath_log/$(date +%Y)/$(date +%m)/error.$(date +%Y%m%d).logkill -USR1 'cate /opt/nginx/logs/nginx.pid 将这段脚本保存后加入到Linux的crontab守护进程（看crontab那篇博客），让此脚本定时执行，就可以实现日志的每天分割功能了。通过Nginx的信号“USER1”实现了日志的自动切换功能。’","categories":[],"tags":[],"keywords":[]},{"title":"Linux定时运行命令脚本的进程","slug":"Linux定时运行命令脚本的进程","date":"2016-10-17T10:12:37.000Z","updated":"2016-10-17T10:14:06.117Z","comments":true,"path":"2016/10/17/Linux定时运行命令脚本的进程/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Linux定时运行命令脚本的进程/","excerpt":"一、cron的三个配置文件","text":"一、cron的三个配置文件 1、/etc/crontab1234567891011121314SHELL=/bin/bashPATH=/sbin:/bin:/usr/sbin:/usr/binMAILTO=root# For details see man 4 crontabs# Example of job definition:# .---------------- minute (0 - 59)# | .------------- hour (0 - 23)# | | .---------- day of month (1 - 31)# | | | .------- month (1 - 12) OR jan,feb,mar,apr ...# | | | | .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat# | | | | |# * * * * * user-name command to be executed 2、/etc/cron.d 该目录下存放需要运行的脚本或文件。12345# Run the hourly jobsSHELL=/bin/bashPATH=/sbin:/bin:/usr/sbin:/usr/binMAILTO=root01 * * * * root run-parts /etc/cron.hourly 3、/var/spool该目录下存放的是用户创建的crontab任务。 二、权限crontab权限问题到/var/adm/cron/下一看，文件cron.allow和cron.deny是否存在用法如下：1、如果两个文件都不存在，则只有root用户才能使用crontab命令。2、如果cron.allow存在但cron.deny不存在，则只有列在cron.allow文件里的用户才能使用crontab命令，如果root用户也不在里面，则root用户也不能使用crontab。3、如果cron.allow不存在, cron.deny存在，则只有列在cron.deny文件里面的用户不能使用crontab命令，其它用户都能使用。4、如果两个文件都存在，则列在cron.allow文件中而且没有列在cron.deny中的用户可以使用crontab，如果两个文件中都有同一个用户，以cron.allow文件里面是否有该用户为准，如果cron.allow中有该用户，则可以使用crontab命令。 AIX 中 普通用户默认都有 crontab 权限，如果要限制用户使用 crontab ,就需要编辑/var/adm/cron/cron.denyHP-UNIX 中默认普通用户没得crontab 权限 ，要想放开普通用户的crontab 权限可以编 三、 创建cron脚本第一步：写cron脚本文件,命名为crontest.cron。15,30,45,59 echo “xgmtest…..” &gt;&gt; xgmtest.txt 表示，每隔15分钟，执行打印一次命令第二步：添加定时任务。执行命令 “crontab crontest.cron”。搞定第三步：”crontab -l” 查看定时任务是否成功或者检测/var/spool/cron下是否生成对应cron脚本","categories":[],"tags":[],"keywords":[]},{"title":"选择Nginx的优势","slug":"选择Nginx的优势","date":"2016-10-17T10:11:28.000Z","updated":"2016-10-17T10:12:29.324Z","comments":true,"path":"2016/10/17/选择Nginx的优势/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/选择Nginx的优势/","excerpt":"1、作为Web服务器，Nginx处理静态文件、索引文件，自动索引的效率非常高。 2、作为代理服务器，Nginx可以实现无缓存的反向代理加速，提高网站运行速度。","text":"1、作为Web服务器，Nginx处理静态文件、索引文件，自动索引的效率非常高。 2、作为代理服务器，Nginx可以实现无缓存的反向代理加速，提高网站运行速度。 3、作为负载均衡服务器，Nginx既可以在内部直接Rails和PHP，也可以支持HTTP大力服务器对外进行服务，同时还支持简单的容错和利用算法进行负载均衡。 4、在性能方面，Nginx是专门为性能优化而开发的，在实现上非常注重效率。他采用内核Poll模型，可以支持更多的并发连接，最大可以支持对50000个并发连接的响应，而且占用很顶的内存资源。 5、在稳定性方面，Nginx采取了分阶段资源分配技术，使得CPU与内存的占用率非常低。Nginx官方表示，Nginx保持10000个没有活动的连接，而这些连接只占用2.5MB的内存，因此，类似DOS这样的攻击对Nginx来说基本上是没有任何作用的。​ 6、在高可用性方面，Nginx支持热部署，启动速递特别迅速，因此可以在不间断服务的情况下，对软件版本或者配置进行升级，即使运行数月也无需重新启动，几乎可以做到7×24小时不间断地运行。​","categories":[],"tags":[],"keywords":[]},{"title":"改变Nginx的默认目录为/var/www","slug":"改变Nginx的默认目录为-var-www","date":"2016-10-17T10:10:41.000Z","updated":"2016-10-17T10:11:22.767Z","comments":true,"path":"2016/10/17/改变Nginx的默认目录为-var-www/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/改变Nginx的默认目录为-var-www/","excerpt":"今天刚接触nginx服务器，发现它太强大了，但是它的默认目录不是/var/www，用惯了Apache服务器，所以想把Nginx的根目录迁移到/var/www下，尝试了一番，可做如下配置：1、进入/etc/aginx/conf/vhosts目录，编辑default.conf文件下的root对应的值，将网站根目录改成你想要的目录。2、保存，使用kill -HUP 主进程号 命令平滑重启nginx服务器，然后打开浏览器，你会发现出现 403 FORBIDDEN 错误，解决办法是将你想要的网站根目录加入到www:www用户组。","text":"今天刚接触nginx服务器，发现它太强大了，但是它的默认目录不是/var/www，用惯了Apache服务器，所以想把Nginx的根目录迁移到/var/www下，尝试了一番，可做如下配置：1、进入/etc/aginx/conf/vhosts目录，编辑default.conf文件下的root对应的值，将网站根目录改成你想要的目录。2、保存，使用kill -HUP 主进程号 命令平滑重启nginx服务器，然后打开浏览器，你会发现出现 403 FORBIDDEN 错误，解决办法是将你想要的网站根目录加入到www:www用户组。 Nginx服务器一些常用的命令： Nginx -v 查看版本号 Nginx -V 查看版本号及相关编译信息 Nginx -t 检测配置文件是否正确 Nginx -t -c 配置文件目录 检测指定配置文件是否正确 kill -HUP 主进程号 平滑重启nginx服务器 ​","categories":[],"tags":[],"keywords":[]},{"title":"Nginx负载均衡配置","slug":"Nginx负载均衡配置","date":"2016-10-17T10:08:50.000Z","updated":"2016-10-17T10:10:12.574Z","comments":true,"path":"2016/10/17/Nginx负载均衡配置/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/Nginx负载均衡配置/","excerpt":"对于一个大型网站来说，负载均衡是永恒的话题，负载均衡，顾名思义，即使将负载分摊到不同的服务单元，既可以保证服务的可用性，又可以保证响应足够快，给用户很好的体验。nginx负载均衡软件是目前大受欢迎的软件之一。下面通过Nginx的反向代理功能配置一个Nginx负载均衡服务器。","text":"对于一个大型网站来说，负载均衡是永恒的话题，负载均衡，顾名思义，即使将负载分摊到不同的服务单元，既可以保证服务的可用性，又可以保证响应足够快，给用户很好的体验。nginx负载均衡软件是目前大受欢迎的软件之一。下面通过Nginx的反向代理功能配置一个Nginx负载均衡服务器。 在/etc/nginx/conf/目录下新建一个配置文件http_proxy.conf，内容如下 1234567upstream myserver &#123; server 需要代理的服务器地址或域名 weight=3 max_fails=3 fail_timeout=20s;​ ......&#125;​ 在上面定义的负载均衡组myserver中，组名可以根据需要随便取。 在/etc/nginx/conf/vhosts/目录下配置default.conf文件，内容如下：12345678910111213141516171819server &#123; listen 80; server_name www.domain.com ip地址; index index.html index.htm index.php;​ root 网站目录location / &#123; proxy_pass http://myserver; proxy_next_upstream http_500 http_502 http_503 error timeout invalid_header;​ include /alidata/server/nginx/conf/proxy.conf;​&#125;​ proxy_next_upstream 用来定义故障转移策略，当后端服务节点返回500、502、503、504和执行超时等错误时，自动将请求转发到updtream负载均衡组中的另一台服务器，实现故障转移。 proxy.conf内容如下：1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071Nginx负载均衡配置编辑删除转载2015-10-25 15:01:28标签：linux服务器nginx 对于一个大型网站来说，负载均衡是永恒的话题，负载均衡，顾名思义，即使将负载分摊到不同的服务单元，既可以保证服务的可用性，又可以保证响应足够快，给用户很好的体验。nginx负载均衡软件是目前大受欢迎的软件之一。下面通过Nginx的反向代理功能配置一个Nginx负载均衡服务器。1、在/etc/nginx/conf/目录下新建一个配置文件http_proxy.conf，内容如下：upstream myserver &#123; server 需要代理的服务器地址或域名 weight=3 max_fails=3 fail_timeout=20s;​ ......&#125;​ 在上面定义的负载均衡组myserver中，组名可以根据需要随便取。2、在/etc/nginx/conf/vhosts/目录下配置default.conf文件，内容如下：server &#123; listen 80; server_name www.domain.com ip地址; index index.html index.htm index.php;​ root 网站目录location / &#123; proxy_pass http://myserver; proxy_next_upstream http_500 http_502 http_503 error timeout invalid_header;​ include /alidata/server/nginx/conf/proxy.conf;​&#125;​proxy_next_upstream 用来定义故障转移策略，当后端服务节点返回500、502、503、504和执行超时等错误时，自动将请求转发到updtream负载均衡组中的另一台服务器，实现故障转移。proxy.conf内容如下：​proxy_redirect off;proxy_set_header Host $host;proxy_set_header X-Real-IP $remote_addr;proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;client_body_buffer_size 128k;proxy_connect_timeout 90;proxy_send_timeout 90;proxy_read_timeout 90;proxy_buffer_size 4k;proxy_buffers 4 32k;proxy_busy_buffers_size 64k;proxy_temp_file_write_size 64k; proxy_set_header: 设置由后端的服务器获取用户的主机名或真实的IP地址，以及代理者真是IP地址。 client_body_buffer_size:用于指定客户端请求主体缓存大小。，可以理解为先保存到本地在传给用户。 proxy_connect_timeout: 表示与后端服务器连接的超时时间，即发起握手等候响应的超时时间。 proxy_send_timeout: 表示于后端服务器数据回传时间，即规定时间组织内后端服务器必须穿万所有数据，否则，Nginx将断口开这个连接。 ​proxy_read_timeout:设置Nginx从代理的后端服务器获取信息的时间 proxy_bufferr_size:设置缓冲区大小。 proxy_buffers:设置缓冲区的数量和大小。 proxy_busy_buffer_size:用于设置系统很忙时可以使用的proxy_buffers大小。 proxy_temp_file_write-sizeL指定proxy缓存临时文件的大小。​","categories":[],"tags":[],"keywords":[]},{"title":"用dockerfile构建基于ubuntu的lnmp环境的镜像","slug":"用dockerfile构建基于ubuntu的lnmp环境的镜像","date":"2016-10-17T10:05:45.000Z","updated":"2016-10-17T10:07:54.394Z","comments":true,"path":"2016/10/17/用dockerfile构建基于ubuntu的lnmp环境的镜像/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/用dockerfile构建基于ubuntu的lnmp环境的镜像/","excerpt":"本文主要讲述的是如何用dockerfile构建lnmp环境的镜像，前提默认你已安装好docker","text":"本文主要讲述的是如何用dockerfile构建lnmp环境的镜像，前提默认你已安装好docker 一、新建Dockerfile文件12345678910111213141516171819202122232425262728FROM ubuntu:16.04MAINTAINER turtle &quot;turtle@anasit.com&quot;RUN \\ apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0xcbcb082a1bb943db &amp;&amp; \\ apt-get update &amp;&amp; \\ apt-get install -y mariadb-server mariadb-common &amp;&amp; \\ apt-get install -y php &amp;&amp; \\ apt-get install -y nginx &amp;&amp; \\ apt-get install -y vim # 配置nginxCopy ./default /etc/nginx/sites-available/default# 添加启动脚本ADD ./start.sh /start.shRUN chmod 755 /start.shCMD /start.sh &amp;&amp; tail -f# Expose ports.EXPOSE 3306EXPOSE 80 start.sh文件1234567## start nginxservice nginx start## start mysqlservice mysql start## start php7.0-fpmservice php7.0-fpm start default文件1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586# You should look at the following URL&apos;s in order to grasp a solid understanding# of Nginx configuration files in order to fully unleash the power of Nginx.# http://wiki.nginx.org/Pitfalls# http://wiki.nginx.org/QuickStart# http://wiki.nginx.org/Configuration## Generally, you will want to move this file somewhere, and start with a clean### You should look at the following URL&apos;s in order to grasp a solid understanding# of Nginx configuration files in order to fully unleash the power of Nginx.# http://wiki.nginx.org/Pitfalls# http://wiki.nginx.org/QuickStart# http://wiki.nginx.org/Configuration## Generally, you will want to move this file somewhere, and start with a clean# file but keep this around for reference. Or just disable in sites-enabled.## Please see /usr/share/doc/nginx-doc/examples/ for more detailed examples.### Default server configuration#server &#123; listen 80 default_server; listen [::]:80 default_server; # SSL configuration # # listen 443 ssl default_server; # listen [::]:443 ssl default_server; # # Note: You should disable gzip for SSL traffic. # See: https://bugs.debian.org/773332 # # Read up on ssl_ciphers to ensure a secure configuration. # See: https://bugs.debian.org/765782 # # Self signed certs generated by the ssl-cert package # Don&apos;t use them in a production server! # # include snippets/snakeoil.conf; root /var/www/html; # Add index.php to the list if you are using PHP index index.php index.html index.htm index.nginx-debian.html; server_name _; location / &#123; # First attempt to serve request as file, then # as directory, then fall back to displaying a 404. try_files $uri $uri/ =404; &#125; # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # location ~ \\.php$ &#123; include snippets/fastcgi-php.conf; # With php7.0-cgi alone:# fastcgi_pass 127.0.0.1:9000; # With php7.0-fpm: fastcgi_pass unix:/run/php/php7.0-fpm.sock; &#125;# deny access to .htaccess files, if Apache&apos;s document root# concurs with nginx&apos;s one##location ~ /\\.ht &#123;# deny all;#&#125;&#125;# Virtual Host configuration for example.com## You can move that to a different file under sites-available/ and symlink that# to sites-enabled/ to enable it.##server &#123;# listen 80;# listen [::]:80;## server_name example.com;## root /var/www/example.com;# index index.html;## location / &#123;# try_files $uri $uri/ =404;# &#125;#&#125; 二、build Dockerfile文件1docker build -t turtlell/lnmp:1.0 . 三、运行镜像1docker run -id -p 80:80 -v /var/www/html:/var/www/html turtlell/lnmp 四、访问localhost访问localhost，运行成功，则说明搭建成功 详情请访问github","categories":[],"tags":[],"keywords":[]},{"title":"ubuntu中安装android sdk","slug":"ubuntu中安装android-sdk","date":"2016-10-17T09:12:58.000Z","updated":"2016-10-17T10:08:04.307Z","comments":true,"path":"2016/10/17/ubuntu中安装android-sdk/","link":"","permalink":"http://blog.turtletl.com/2016/10/17/ubuntu中安装android-sdk/","excerpt":"本文阐述的是如何在ubuntu中安装android sdk 环境","text":"本文阐述的是如何在ubuntu中安装android sdk 环境 一、安装python-software-properties1apt-get update &amp;&amp; apt-get install -y -q python-software-properties software-properties-common &amp;&amp; apt-get clean 二、安装oracle java from PPA12345add-apt-repository ppa:webupd8team/java -yecho oracle-java8-installer shared/accepted-oracle-license-v1-1 select true | /usr/bin/debconf-set-selectionsapt-get update &amp;&amp; apt-get -y install oracle-java7-installer &amp;&amp; apt-get clean 三、ANDROID STUFF1dpkg --add-architecture i386 &amp;&amp; apt-get update &amp;&amp; apt-get install -y --force-yes expect ant wget libc6-i386 lib32stdc++6 lib32gcc1 lib32ncurses5 lib32z1 qemu-kvm kmod &amp;&amp; apt-get clean 四、安装Android SDK1cd /opt &amp;&amp; wget --output-document=android-sdk.tgz --quiet http://dl.google.com/android/android-sdk_r24.0.2-linux.tgz &amp;&amp; tar xzf android-sdk.tgz &amp;&amp; rm -f android-sdk.tgz 五、配置环境在/etc/profile文件末尾加上如下代码 12export ANDROID_HOME=/opt/android-sdk-linuxexport PATH=$&#123;PATH&#125;:$&#123;ANDROID_HOME&#125;/tools:$&#123;ANDROID_HOME&#125;/platform-tools 1source /etc/profile 六、安装sdk elements新建脚本/opt/tools/android-accept-licenses.sh12345678910111213#!/usr/bin/expect -fset timeout 1800set cmd [lindex $argv 0]set licenses [lindex $argv 1]spawn &#123;*&#125;$cmdexpect &#123;&quot;Do you accept the license &apos;*&apos;*&quot; &#123; exp_send &quot;y\\r&quot; exp_continue&#125;eof 1chmod 755 /opt/tools/android-accept-licenses.sh 在/etc/profile文件末尾加上如下代码 1export PATH=$PATH:/opt/tools 1echo ANDROID_HOME=&quot;$&#123;ANDROID_HOME&#125;&quot; &gt;&gt; /etc/environment 运行脚本并更新 1/opt/tools/android-accept-licenses.sh 1android update sdk --all --no-ui --filter platform-tools,tools,build-tools23,android-23,addon-google_apis_x86-google-23,extra-android-support,extra-android-m2repository,extra-google-m2repository,sys-img-x86-android-23 --proxy-host mirrors.neusoft.edu.cn --proxy-port 80 -s","categories":[],"tags":[],"keywords":[]}]}